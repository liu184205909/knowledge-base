# è§†é¢‘è‡ªåŠ¨åŒ–:ç›´æ¥è°ƒç”¨AI API

> **AIè§†é¢‘ç”Ÿæˆçš„åº•å±‚å®ç°** | 2025å¹´å¼ºåŒ–ç‰ˆ | èšç„¦APIè€Œéç¬¬ä¸‰æ–¹å·¥å…·

---

## ğŸ¯ æ ¸å¿ƒç†å¿µ

**ä¸è¦ä½¿ç”¨å°è£…å·¥å…·,ç›´æ¥è°ƒç”¨AIè§†é¢‘ç”ŸæˆAPI!**

```
âŒ é”™è¯¯æ–¹å¼:
InVideo AI/Fliki â†’ å°è£…å·¥å…· â†’ æˆæœ¬æ›´é«˜,åŠŸèƒ½å—é™

âœ… æ­£ç¡®æ–¹å¼:
Runway API / Pika API / Kling API â†’ ç›´æ¥è°ƒç”¨ â†’ æˆæœ¬æ›´ä½,å®Œå…¨æ§åˆ¶
```

---

## ğŸš€ ä¸‰ç§å®ç°æ–¹å¼

### æ–¹å¼1: MCPå·¥å…·é›†æˆ (æœ€ç®€å•)

**é€‚ç”¨åœºæ™¯**: å¿«é€Ÿç”Ÿæˆ,æ— éœ€ä»£ç 

**MCPé…ç½®**:
```json
{
  "mcpServers": {
    "runway": {
      "command": "npx",
      "args": ["-y", "@modelcontextprotocol/server-runway"]
    }
  }
}
```

**åœ¨Claude Codeä¸­ä½¿ç”¨**:
```bash
# ç›´æ¥è°ƒç”¨Runway Gen-2ç”Ÿæˆè§†é¢‘
è¯·ä½¿ç”¨Runway APIä¸ºæ–‡ç« "AIå·¥å…·çš„ä½¿ç”¨æŠ€å·§"ç”Ÿæˆä¸€ä¸ª30ç§’çš„ä»‹ç»è§†é¢‘
é£æ ¼: ä¸“ä¸šå•†åŠ¡
åˆ†è¾¨ç‡: 1080p
```

---

### æ–¹å¼2: Pythonè„šæœ¬ (æ¨è,æœ€çµæ´»)

**ä¼˜åŠ¿**: å®Œå…¨æ§åˆ¶,æ‰¹é‡å¤„ç†,æˆæœ¬æœ€ä½

**æ‰¹é‡ç”Ÿæˆè§†é¢‘ç¤ºä¾‹**:
```python
import requests
import json
import time

# Runway Gen-2 APIé…ç½®
RUNWAY_API_KEY = "your-api-key"
RUNWAY_API_URL = "https://api.runwayml.com/v1/generate"

def generate_video_with_text(prompt, duration=5):
    """ä½¿ç”¨æ–‡æœ¬ç”Ÿæˆè§†é¢‘"""

    headers = {
        "Authorization": f"Bearer {RUNWAY_API_KEY}",
        "Content-Type": "application/json"
    }

    data = {
        "model": "gen2",
        "promptText": prompt,
        "duration": duration,
        "ratio": "16:9"
    }

    response = requests.post(RUNWAY_API_URL, headers=headers, json=data)
    return response.json()

def generate_video_with_image(image_url, prompt):
    """ä½¿ç”¨å›¾ç‰‡ç”Ÿæˆè§†é¢‘"""

    headers = {
        "Authorization": f"Bearer {RUNWAY_API_KEY}",
        "Content-Type": "application/json"
    }

    data = {
        "model": "gen2",
        "imageUrl": image_url,
        "promptText": prompt,
        "motion": 5  # è¿åŠ¨å¼ºåº¦ 1-10
    }

    response = requests.post(RUNWAY_API_URL, headers=headers, json=data)
    return response.json()

# æ‰¹é‡ç”Ÿæˆç¤ºä¾‹
articles = [
    {"title": "AIå·¥å…·ä»‹ç»", "image": "https://example.com/img1.jpg"},
    {"title": "ChatGPTæŠ€å·§", "image": "https://example.com/img2.jpg"},
    # ...æ›´å¤šæ–‡ç« 
]

for article in articles:
    # 1. åŸºäºæ–‡ç« æ ‡é¢˜ç”Ÿæˆè§†é¢‘è„šæœ¬
    script = f"å…³äº{article['title']}çš„è¯¦ç»†ä»‹ç»,åŒ…å«æ ¸å¿ƒè¦ç‚¹å’Œå®ç”¨æŠ€å·§"

    # 2. ä½¿ç”¨å›¾ç‰‡ç”Ÿæˆè§†é¢‘
    video_result = generate_video_with_image(article['image'], script)

    # 3. ä¿å­˜è§†é¢‘URL
    print(f"è§†é¢‘ç”Ÿæˆå®Œæˆ: {video_result['url']}")

    # 4. é¿å…é€Ÿç‡é™åˆ¶
    time.sleep(2)
```

**æˆæœ¬è®¡ç®—**:
```bash
Runway Gen-2 APIå®šä»·:
- Standard: $12/æœˆ(125 credits)
- 1ä¸ª4ç§’è§†é¢‘ = 5 credits
- 25ä¸ªè§†é¢‘/æœˆ = $12

vs å°è£…å·¥å…·(InVideo AI: $25/æœˆ)
- æˆæœ¬é™ä½: 52%
- åŠŸèƒ½æ›´å¼º: å¯å®šåˆ¶åŒ–
```

---

### æ–¹å¼3: n8nå·¥ä½œæµ (å¯è§†åŒ–)

**ä¼˜åŠ¿**: å¯è§†åŒ–,æ— éœ€ç¼–ç¨‹,æ˜“äºç»´æŠ¤

**n8nå·¥ä½œæµç¤ºä¾‹**:
```javascript
// Node 1: è¯»å–æ–‡ç« åˆ—è¡¨
èŠ‚ç‚¹ç±»å‹: Spreadsheet File
æ“ä½œ: Read
æ–‡ä»¶: articles.csv

// Node 2: å¾ªç¯å¤„ç†
èŠ‚ç‚¹ç±»å‹: Split In Batches
æ‰¹æ¬¡å¤§å°: 5

// Node 3: ç”Ÿæˆè§†é¢‘è„šæœ¬
èŠ‚ç‚¹ç±»å‹: HTTP Request
URL: https://api.anthropic.com/v1/messages
Method: POST
Body:
{
  "model": "claude-3-5-sonnet-20241022",
  "max_tokens": 500,
  "messages": [{
    "role": "user",
    "content": "ä¸ºæ–‡ç« '{{$json.title}}'ç”Ÿæˆ30ç§’è§†é¢‘è„šæœ¬"
  }]
}

// Node 4: è°ƒç”¨Runway API
èŠ‚ç‚¹ç±»å‹: HTTP Request
URL: https://api.runwayml.com/v1/generate
Method: POST
Body:
{
  "model": "gen2",
  "imageUrl": "{{$json.cover_image}}",
  "promptText": "{{$json.video_script}}",
  "duration": 5
}

// Node 5: ç­‰å¾…ç”Ÿæˆå®Œæˆ
èŠ‚ç‚¹ç±»å‹: Wait
æ—¶é—´: 60ç§’

// Node 6: ä¸‹è½½è§†é¢‘
èŠ‚ç‚¹ç±»å‹: HTTP Request
URL: {{$json.video_url}}
Method: GET

// Node 7: ä¿å­˜åˆ°äº‘å­˜å‚¨
èŠ‚ç‚¹ç±»å‹: AWS S3 / Google Cloud Storage
æ“ä½œ: Upload

// Node 8: è®°å½•ç»“æœ
èŠ‚ç‚¹ç±»å‹: Google Sheets
æ“ä½œ: Append
```

---

## ğŸ“Š åº•å±‚AIè§†é¢‘ç”ŸæˆAPIå¯¹æ¯”

### ä¸»æµAPIå¯¹æ¯”

| API | ä»·æ ¼ | è´¨é‡ | é€Ÿåº¦ | æ¨èåº¦ |
|-----|------|------|------|--------|
| **Runway Gen-2** | $0.10/ç§’ | â­â­â­â­â­ | å¿« | â­â­â­â­â­ |
| **Pika Labs** | $0.01/ç§’ | â­â­â­â­ | å¿« | â­â­â­â­ |
| **Kling AI** | Â¥0.05/ç§’ | â­â­â­â­ | å¿« | â­â­â­â­ (å›½å†…) |
| **Sora API** | æœªå…¬å¼€ | â­â­â­â­â­ | æ…¢ | â­â­â­â­â­ (å¦‚æœèƒ½è®¿é—®) |

---

## ğŸ¬ å®Œæ•´è§†é¢‘è‡ªåŠ¨åŒ–æµæ°´çº¿

### åœºæ™¯: æ–‡ç«  â†’ è§†é¢‘è„šæœ¬ â†’ AIé…éŸ³ â†’ è§†é¢‘ç”Ÿæˆ

```python
import requests
import os
from typing import Dict, List

class VideoAutomationPipeline:
    """è§†é¢‘è‡ªåŠ¨åŒ–æµæ°´çº¿"""

    def __init__(self):
        self.claude_api_key = os.getenv("ANTHROPIC_API_KEY")
        self.runway_api_key = os.getenv("RUNWAY_API_KEY")
        self.elevenlabs_api_key = os.getenv("ELEVENLABS_API_KEY")

    def generate_script(self, article_title: str, article_content: str) -> str:
        """ç”Ÿæˆè§†é¢‘è„šæœ¬"""

        response = requests.post(
            "https://api.anthropic.com/v1/messages",
            headers={
                "x-api-key": self.claude_api_key,
                "Content-Type": "application/json",
                "anthropic-version": "2023-06-01"
            },
            json={
                "model": "claude-3-5-sonnet-20241022",
                "max_tokens": 1000,
                "messages": [{
                    "role": "user",
                    "content": f"""åŸºäºä»¥ä¸‹æ–‡ç« ç”Ÿæˆ30ç§’è§†é¢‘è„šæœ¬:

æ ‡é¢˜: {article_title}

å†…å®¹: {article_content}

è¦æ±‚:
1. å¼€åœº(5ç§’): æŠ“ä½æ³¨æ„åŠ›
2. ä»‹ç»(15ç§’): æ ¸å¿ƒè¦ç‚¹
3. ç»“å°¾(10ç§’): è¡ŒåŠ¨å·å¬

è¯·ç›´æ¥è¿”å›è„šæœ¬å†…å®¹,ä¸è¦å…¶ä»–è¯´æ˜ã€‚"""
                }]
            }
        )

        return response.json()["content"][0]["text"]

    def generate_voiceover(self, script: str, output_file: str) -> str:
        """ç”ŸæˆAIé…éŸ³"""

        response = requests.post(
            f"https://api.elevenlabs.io/v1/text-to-speech/{voice_id}",
            headers={
                "xi-api-key": self.elevenlabs_api_key,
                "Content-Type": "application/json"
            },
            json={
                "text": script,
                "model_id": "eleven_multilingual_v2",
                "voice_settings": {
                    "stability": 0.5,
                    "similarity_boost": 0.5
                }
            }
        )

        # ä¿å­˜éŸ³é¢‘æ–‡ä»¶
        with open(output_file, 'wb') as f:
            f.write(response.content)

        return output_file

    def generate_video(self, prompt: str, image_url: str = None) -> str:
        """ç”Ÿæˆè§†é¢‘"""

        headers = {
            "Authorization": f"Bearer {self.runway_api_key}",
            "Content-Type": "application/json"
        }

        if image_url:
            # å›¾ç”Ÿè§†é¢‘
            data = {
                "model": "gen2",
                "imageUrl": image_url,
                "promptText": prompt,
                "duration": 5
            }
        else:
            # æ–‡ç”Ÿè§†é¢‘
            data = {
                "model": "gen2",
                "promptText": prompt,
                "duration": 5
            }

        response = requests.post(
            "https://api.runwayml.com/v1/generate",
            headers=headers,
            json=data
        )

        return response.json()["url"]

    def full_pipeline(self, articles: List[Dict]) -> List[Dict]:
        """å®Œæ•´æµæ°´çº¿"""

        results = []

        for article in articles:
            try:
                # 1. ç”Ÿæˆè„šæœ¬
                script = self.generate_script(
                    article["title"],
                    article["content"]
                )

                # 2. ç”Ÿæˆé…éŸ³
                audio_file = f"audio/{article['id']}.mp3"
                self.generate_voiceover(script, audio_file)

                # 3. ç”Ÿæˆè§†é¢‘
                video_url = self.generate_video(
                    script,
                    article.get("cover_image")
                )

                results.append({
                    "article_id": article["id"],
                    "script": script,
                    "audio_file": audio_file,
                    "video_url": video_url,
                    "status": "success"
                })

            except Exception as e:
                results.append({
                    "article_id": article["id"],
                    "error": str(e),
                    "status": "failed"
                })

        return results

# ä½¿ç”¨ç¤ºä¾‹
pipeline = VideoAutomationPipeline()

articles = [
    {
        "id": 1,
        "title": "AIå·¥å…·æé«˜æ•ˆç‡çš„5ç§æ–¹æ³•",
        "content": "æ–‡ç« å†…å®¹...",
        "cover_image": "https://example.com/cover.jpg"
    },
    # ...æ›´å¤šæ–‡ç« 
]

results = pipeline.full_pipeline(articles)
```

---

## ğŸ’° æˆæœ¬ä¼˜åŒ–ç­–ç•¥

### APIç›´æ¥è°ƒç”¨ vs å°è£…å·¥å…·

| æ–¹å¼ | æœˆæˆæœ¬ | ä¼˜åŠ¿ | åŠ£åŠ¿ |
|------|-------|------|------|
| **å°è£…å·¥å…·** (InVideo AI) | $25/æœˆ | æ— éœ€ä»£ç  | åŠŸèƒ½å—é™ |
| **Runway APIç›´æ¥è°ƒç”¨** | $12/æœˆ | å®Œå…¨æ§åˆ¶ | éœ€è¦ç¼–ç¨‹ |
| **æˆæœ¬èŠ‚çº¦** | **52%** | - | - |

### æ‰¹é‡ç”Ÿæˆæˆæœ¬è®¡ç®—

```python
# ç”Ÿæˆ100ä¸ªè§†é¢‘çš„æˆæœ¬

æ–¹å¼1: å°è£…å·¥å…·(InVideo AI)
- æœˆè´¹: $25
- é™åˆ¶: å¯èƒ½æœ‰æ•°é‡é™åˆ¶
- æ€»æˆæœ¬: $25/æœˆ

æ–¹å¼2: Runway APIç›´æ¥è°ƒç”¨
- 125 credits/æœˆ = $12
- æ¯ä¸ªè§†é¢‘4ç§’ = 5 credits
- å¯ç”Ÿæˆ: 25ä¸ªè§†é¢‘/æœˆ
- 100ä¸ªè§†é¢‘éœ€è¦: $48/æœˆ

æ–¹å¼3: Pika Labs API(æ›´ä¾¿å®œ)
- æ¯ä¸ª3-4ç§’è§†é¢‘ = $0.04
- 100ä¸ªè§†é¢‘ = $4/æœˆ
- **æœ€ç»æµé€‰æ‹©**
```

---

## ğŸ”§ é«˜çº§æŠ€å·§

### æŠ€å·§1: æ‰¹é‡ç”Ÿæˆ+é”™è¯¯å¤„ç†

```python
from concurrent.futures import ThreadPoolExecutor
import time

def generate_video_with_retry(article, max_retries=3):
    """å¸¦é‡è¯•çš„è§†é¢‘ç”Ÿæˆ"""

    for attempt in range(max_retries):
        try:
            video_url = pipeline.generate_video(
                article["script"],
                article.get("cover_image")
            )
            return {"article_id": article["id"], "video_url": video_url}

        except Exception as e:
            if attempt == max_retries - 1:
                return {"article_id": article["id"], "error": str(e)}
            time.sleep(5 * (attempt + 1))  # æŒ‡æ•°é€€é¿

# å¹¶å‘ç”Ÿæˆ
with ThreadPoolExecutor(max_workers=3) as executor:
    results = list(executor.map(generate_video_with_retry, articles))
```

### æŠ€å·§2: æ™ºèƒ½é€‰æ‹©API

```python
def choose_video_api(quality_requirement: str) -> str:
    """æ ¹æ®éœ€æ±‚é€‰æ‹©API"""

    if quality_requirement == "highest":
        return "runway"  # è´¨é‡æœ€é«˜
    elif quality_requirement == "cost":
        return "pika"    # æˆæœ¬æœ€ä½
    else:
        return "kling"   # å¹³è¡¡é€‰æ‹©

# ä½¿ç”¨
api = choose_video_api("cost")
video_url = generate_video_with_api(api, prompt)
```

### æŠ€å·§3: ç¼“å­˜å’Œå»é‡

```python
import hashlib
import json

def cache_key(prompt: str, image_url: str) -> str:
    """ç”Ÿæˆç¼“å­˜é”®"""
    content = f"{prompt}_{image_url}"
    return hashlib.md5(content.encode()).hexdigest()

def generate_video_with_cache(prompt: str, image_url: str):
    """å¸¦ç¼“å­˜çš„è§†é¢‘ç”Ÿæˆ"""

    key = cache_key(prompt, image_url)

    # æ£€æŸ¥ç¼“å­˜
    if cache.exists(key):
        return cache.get(key)

    # ç”Ÿæˆæ–°è§†é¢‘
    video_url = generate_video(prompt, image_url)

    # ä¿å­˜åˆ°ç¼“å­˜
    cache.set(key, video_url, expire=86400*30)  # 30å¤©

    return video_url
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [01-å›¾ç‰‡è‡ªåŠ¨åŒ–.md](./01-å›¾ç‰‡è‡ªåŠ¨åŒ–.md) - å›¾ç‰‡ç”ŸæˆAPI
- [03-æ‰¹é‡ç”Ÿäº§æµæ°´çº¿.md](./03-æ‰¹é‡ç”Ÿäº§æµæ°´çº¿.md) - å¤šAgentåä½œ
- [04-ç¤¾åª’å‘å¸ƒè‡ªåŠ¨åŒ–.md](./04-ç¤¾åª’å‘å¸ƒè‡ªåŠ¨åŒ–.md) - å¤šå¹³å°å‘å¸ƒ

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **APIå¯†é’¥å®‰å…¨**: ä½¿ç”¨ç¯å¢ƒå˜é‡,ä¸è¦ç¡¬ç¼–ç 
2. **é€Ÿç‡é™åˆ¶**: æ³¨æ„APIè°ƒç”¨é¢‘ç‡é™åˆ¶
3. **æˆæœ¬æ§åˆ¶**: æ‰¹é‡ç”Ÿæˆå‰å…ˆæµ‹è¯•æˆæœ¬
4. **å†…å®¹å®¡æ ¸**: AIç”Ÿæˆè§†é¢‘éœ€è¦äººå·¥å®¡æ ¸
5. **ç‰ˆæƒé—®é¢˜**: äº†è§£AIç”Ÿæˆè§†é¢‘çš„ç‰ˆæƒå½’å±

---

**åˆ›å»ºæ—¶é—´**: 2025-12-29
**å¼ºåŒ–æ—¶é—´**: 2026-01-11
**æ ¸å¿ƒç†å¿µ**: ç›´æ¥è°ƒç”¨API,æ‹’ç»å°è£…å·¥å…·! ğŸš€
